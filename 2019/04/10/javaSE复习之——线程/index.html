<!DOCTYPE html><html class="theme-next gemini use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><script type="text/javascript" src="/js/src/clicklove.js"></script><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>!function(e,t,o,c,a,i,n){e.DaoVoiceObject=a,e[a]=e[a]||function(){(e[a].q=e[a].q||[]).push(arguments)},e[a].l=1*new Date,i=t.createElement(o),n=t.getElementsByTagName(o)[0],i.async=1,i.src=c,i.charset="utf-8",n.parentNode.insertBefore(i,n)}(window,document,"script",("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/71c3d6a3.js","daovoice"),daovoice("init",{app_id:"71c3d6a3"}),daovoice("update")</script><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="线程,两种实现多线程的区别（面试可能问）,同步代码块（锁）,"><link rel="alternate" href="/atom.xml" title="Ather · Blog" type="application/atom+xml"><meta name="description" content="线程概述 线程其实就是程序执行的一条路径，一个进程中可以包含多条线程，多线程并发执行可以提高程序效率，可以同使完成多项任务"><meta name="keywords" content="线程,两种实现多线程的区别（面试可能问）,同步代码块（锁）"><meta property="og:type" content="article"><meta property="og:title" content="javaSE复习之——线程"><meta property="og:url" content="http://liuhaoan.github.io/2019/04/10/javaSE复习之——线程/index.html"><meta property="og:site_name" content="Ather · Blog"><meta property="og:description" content="线程概述 线程其实就是程序执行的一条路径，一个进程中可以包含多条线程，多线程并发执行可以提高程序效率，可以同使完成多项任务"><meta property="og:locale" content="zh-Hans"><meta property="og:updated_time" content="2019-04-10T09:43:04.563Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="javaSE复习之——线程"><meta name="twitter:description" content="线程概述 线程其实就是程序执行的一条路径，一个进程中可以包含多条线程，多线程并发执行可以提高程序效率，可以同使完成多项任务"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Gemini",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://liuhaoan.github.io/2019/04/10/javaSE复习之——线程/"><title>javaSE复习之——线程 | Ather · Blog</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div> <a href="/" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Ather · Blog</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-大事年表"><a href="/timelines" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 大事年表</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://liuhaoan.github.io/2019/04/10/javaSE复习之——线程/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="Atcher"><meta itemprop="description" content><meta itemprop="image" content="/images/logo.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Ather · Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">javaSE复习之——线程</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-04-10T17:00:06+08:00">2019-04-10</time></span> <span class="post-category"><span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i></span> <span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/JavaSE-复习/" itemprop="url" rel="index"><span itemprop="name">JavaSE 复习</span></a></span></span> <span class="post-meta-divider">|</span><span class="page-pv"><i class="fa fa-file-o"></i> 浏览<span class="busuanzi-value" id="busuanzi_value_page_pv"></span> 次</span><div class="post-wordcount"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">字数统计&#58;</span> <span title="字数统计">2k</span> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">6</span></div></div></header><div class="post-body" itemprop="articleBody"><h1 id="线程概述"><a href="#线程概述" class="headerlink" title="线程概述"></a>线程概述</h1><blockquote><p>线程其实就是程序执行的一条路径，一个进程中可以包含多条线程，多线程并发执行可以提高程序效率，可以同使完成多项任务</p></blockquote><a id="more"></a><h3 id="多线程的应用场景"><a href="#多线程的应用场景" class="headerlink" title="多线程的应用场景"></a>多线程的应用场景</h3><ul><li>迅雷多线程一起下载</li><li>服务器同时处理多个客户请求</li></ul><h3 id="多线程原理-单核CPU"><a href="#多线程原理-单核CPU" class="headerlink" title="多线程原理(单核CPU)"></a>多线程原理(单核CPU)</h3><blockquote><p>在电脑上运行多个程序时，其实cpu一次只能做一个事，做一段时间后然后换另一个另一个做一段时间，只是cpu的速度太快了，<code>看起来就是同时做很多事</code>，也就是说多线程其实<code>只是表面上的多线程</code>，底层cpu还是一次只能做一个事，但是这有个前提，那就是那个cpu是单核cpu，如果事多核cpu，那么就可以真正的达到<strong><code>并行</code></strong>。</p></blockquote><h3 id="多线程并行和并发的区别"><a href="#多线程并行和并发的区别" class="headerlink" title="多线程并行和并发的区别"></a>多线程并行和并发的区别</h3><ul><li>并行<blockquote><p>并行是两个任务同时运行，需要多核cpu，有多少核就可以并行多少任务。</p></blockquote></li><li>并发<blockquote><p>并发是两个任务都请求运行，而一个处理器只能接受一个任务，就安排两个任务轮流进行，由于时间比较段短就感觉两个任务是同时在运行</p></blockquote></li><li>ps<blockquote><p>我们所谓的多线程就是<strong>并发</strong>，如果不使用多线程，那么程序就是一句一句代码请求，如果使用了多线程，那么就可以这个方法请求运行，同时另一个方法也请求运行，也就是说，<code>没有使用多线程的话代码是一条一条请求，使用了就是多条同时请求，但底层并不是并行</code>，只是cpu处理太快了感觉不到。</p></blockquote></li></ul><h3 id="多线程程序实现方法1"><a href="#多线程程序实现方法1" class="headerlink" title="多线程程序实现方法1"></a>多线程程序实现方法1</h3><blockquote><p>1、定义类继承Thread</p><p>2、重写run方法</p><p>3、把新线程要做的事写在run方法中</p><p>4、创建线程对象，也就是我们定义的这个对象</p><p>5、开启新的线程（start），内部会自动执行run方法</p></blockquote><h3 id="多线程程序实现方法2"><a href="#多线程程序实现方法2" class="headerlink" title="多线程程序实现方法2"></a>多线程程序实现方法2</h3><blockquote><p>1、定义类实现Runnable接口</p><p>2、重写run方法</p><p>3、把新线程要做的事卸载run方法中</p><p>4、创建Thread对象，并且给它的构造方法传入一个实现了Runnable接口类的对象</p><p>5、利用Thread开启新的线程</p></blockquote><h3 id="多线程程序实现方法3"><a href="#多线程程序实现方法3" class="headerlink" title="多线程程序实现方法3"></a>多线程程序实现方法3</h3><ul><li><p>第三种创建多线程的接口</p><blockquote><p>Callable</p></blockquote></li><li><p>创建方式：</p><blockquote><p>1、创建一个线程类，并且继承Callable&lt;&gt;类和重写call方法</p><p>2、创建线程池</p><p>3、创建线程对象然后用submit方法加入线程池即可</p></blockquote></li></ul><h3 id="两种实现多线程的区别（面试可能问）"><a href="#两种实现多线程的区别（面试可能问）" class="headerlink" title="两种实现多线程的区别（面试可能问）"></a>两种实现多线程的区别（面试可能问）</h3><ul><li><p>继承Thread：</p><blockquote><p>因为我们创建的类继承了Thread类，所以当我们调用start时，是直接执行子类的run方法，也就是我们创建的类。</p></blockquote></li><li><p>实现Runnable接口创建对象并传入实例化Thread的构造方法：</p><blockquote><p>我们是先创建实现了Runnable接口的对象，然后创建Thread对象并把之前创建的对象传入Thread构造方法，这时Thread类会把传入的对象保存到成员变量中，当我们调用Thread对象的start方法的时候，Thread对象会调用它的成员变量中的run方法，当然这个成员变量就是我们创建的那个实现了Runnable接口的对象</p></blockquote></li></ul><h3 id="两种实现多线程的好处与坏处"><a href="#两种实现多线程的好处与坏处" class="headerlink" title="两种实现多线程的好处与坏处"></a>两种实现多线程的好处与坏处</h3><ul><li><p>继承Thread：</p><blockquote><ul><li><p>好处：<br>可以直接调用Thread中的方法，这样代码简洁。</p></li><li><p>坏处：<br>既然继承了Thread方法就不能继承其他类了</p></li></ul></blockquote></li><li><p>实现Runnable接口：</p><blockquote><ul><li><p>好处：<br>因为接口是可以多实现的，所以可以继承其他父类</p></li><li><p>坏处：<br>不能直接创建对象使用，代码更加复杂</p></li></ul></blockquote></li><li><p>ps：</p><blockquote><p>个人感觉实现Runnable其实是继承Thread的一个补充，在开发时看情况使用。</p></blockquote></li></ul><h3 id="Thread类的方法"><a href="#Thread类的方法" class="headerlink" title="Thread类的方法"></a>Thread类的方法</h3><ul><li>.start()<blockquote><p>开启线程，多次启动是非法的</p></blockquote></li><li>.getName()<blockquote><p>获取线程名，默认线程名从Thread -0开始以此类推</p></blockquote></li><li>.setName()<blockquote><p>设置线程名</p></blockquote></li><li>.currentThread()<blockquote><p>获取当前线程对象的引用，在哪调用就获取哪的线程</p></blockquote></li><li>.sleep(毫秒, 纳秒)<blockquote><p>休眠线程，传入多少时间就停多长时间，也可以单独传毫秒</p></blockquote></li><li><p>.setDaemon()</p><blockquote><p>守护线程，设置一个线程为守护线程后，该线程不会单独执行，当其他非守护线程全部执行完之后自动退出。</p><ul><li>ps：<br>在非守护线程全部执行完毕后，会有一个缓冲时间，这个缓冲时间内守护线程还会运行，也就相当于非守护线程退出时会告诉守护线程可以退出了，这个告诉的时间就是缓冲时间</li></ul></blockquote></li><li><p>.join()</p><blockquote><p>调用此方法的线程暂停（写这句代码的线程），等待指定线程结束后，当前线程再继续运行</p></blockquote></li><li><p>.join(int)</p><blockquote><p>等待指定的毫秒后继续执行</p><ul><li>ps：<br>如果在main主方法中调用t.join()，那么等待t这个线程执行结束之后，主方法才会继续执行，这个命令通常用在主方法中。</li></ul></blockquote></li><li><p>.yield()</p><blockquote><p>礼让线程，让出cpu，也就是让自己在cpu的执行优先级中降低，就是让别人先执行</p></blockquote></li><li>.setPriority(1-10)<blockquote><p>设置线程优先级，默认是5</p></blockquote></li><li>.getThreadGroup()<blockquote><p>通过线程对象获取它所属的组，返回线程组对象</p></blockquote></li></ul><h3 id="同步代码块的概述"><a href="#同步代码块的概述" class="headerlink" title="同步代码块的概述"></a>同步代码块的概述</h3><blockquote><p>当有多条线程并发的时候，cpu会先执行完<code>同步代码块</code>中所有代码才会去执行另一个线程，<code>不会这里执行几句代码那里执行几句代码</code>。</p><ul><li>ps：<br><strong>它其实就是锁</strong></li></ul></blockquote><h3 id="什么时候需要同步？"><a href="#什么时候需要同步？" class="headerlink" title="什么时候需要同步？"></a>什么时候需要同步？</h3><blockquote><p>当多线程并发，我们希望某个线程中某些代码执行过程中不切换到其他线程工作，我们就需要用到同步代码块。</p></blockquote><h3 id="同步代码块关键字"><a href="#同步代码块关键字" class="headerlink" title="同步代码块关键字"></a>同步代码块关键字</h3><blockquote><p><strong>synchronized</strong></p></blockquote><h3 id="定义方式："><a href="#定义方式：" class="headerlink" title="定义方式："></a>定义方式：</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">synchronized</span><span class="params">(锁对象)</span></span> &#123;</span><br><span class="line">代码块</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="同步代码块（锁）的注意事项："><a href="#同步代码块（锁）的注意事项：" class="headerlink" title="同步代码块（锁）的注意事项："></a>同步代码块（锁）的注意事项：</h3><blockquote><p>1、锁对象可以是任意的对象</p><p>2、两个需要同步的代码块需要使用同一个锁，否则不能达到目标效果</p><p>3、不能是匿名对象，因为两个匿名对象根本就不是一个对象，也就是不是同一把锁</p><p>4、不要把锁进行嵌套，否则容易出现死锁，因为可能会出现互相等待的局面</p></blockquote><h3 id="同步方法如何定义？"><a href="#同步方法如何定义？" class="headerlink" title="同步方法如何定义？"></a>同步方法如何定义？</h3><ul><li>解答：<blockquote><p>只要在修饰方法的时候加上synchronized关键字即可</p></blockquote></li></ul><h3 id="同步方法注意事项："><a href="#同步方法注意事项：" class="headerlink" title="同步方法注意事项："></a>同步方法注意事项：</h3><ul><li>非静态方法锁对象是<code>它自己这个对象</code>，也就是this</li><li>静态方法因为它是随着类的加载而加载的，所以它的对象就是它所在类的<code>字节码文件</code>，也就是说静态方法的锁对象就是它所在类的字节码文件</li></ul><h3 id="线程安全问题"><a href="#线程安全问题" class="headerlink" title="线程安全问题"></a>线程安全问题</h3><blockquote><p>当多条线程操作同一个数据时，可能会出现数据安全问题</p></blockquote><ul><li><p><strong>解决方法</strong></p><blockquote><p>在某一段需要判断并且操作数据地方加上一个同步代码块</p></blockquote></li><li><p><strong>注意事项</strong></p><blockquote><p>使用的锁对象一定要是同一个锁，<code>建议直接用类的class文件</code>，如果非要用引用数据类型，那么一定要用静态的。</p></blockquote></li></ul><h3 id="以前线程安全类的回顾"><a href="#以前线程安全类的回顾" class="headerlink" title="以前线程安全类的回顾"></a>以前线程安全类的回顾</h3><blockquote><p>线程安全的类涉及数据操作的方法都加了synchronized修饰，比如Vector、ArrayList，StringBuffer、StringBuilde</p></blockquote><h3 id="线程安全方法"><a href="#线程安全方法" class="headerlink" title="线程安全方法"></a>线程安全方法</h3><blockquote><p>.synchronized[这里可以后接集合类型，是什么类型就返回那个类型的集合]</p><ul><li>ps：<br>它的作用是传入一个集合对象，传出一个线程安全的集合对象</li></ul></blockquote></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div><div class="my_post_copyright"><script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script><script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script><script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script><p><span>本文标题:</span><a href="/2019/04/10/javaSE复习之——线程/">javaSE复习之——线程</a></p><p><span>文章作者:</span><a href="/" title="访问 Atcher 的个人博客">Atcher</a></p><p><span>发布时间:</span>2019年04月10日 - 17:04</p><p><span>最后更新:</span>2019年04月10日 - 17:04</p><p><span>原始链接:</span><a href="/2019/04/10/javaSE复习之——线程/" title="javaSE复习之——线程">http://liuhaoan.github.io/2019/04/10/javaSE复习之——线程/</a><span class="copy-path" title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="http://liuhaoan.github.io/2019/04/10/javaSE复习之——线程/" aria-label="复制成功！"></i></span></p><p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p></div><script>var clipboard=new Clipboard(".fa-clipboard");$(".fa-clipboard").click(function(){clipboard.on("success",function(){swal({title:"",text:"复制成功",icon:"success",showConfirmButton:!0})})})</script></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>坚持原创技术分享，您的支持将鼓励我继续创作！</div> <button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'> <span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"> <img id="wechat_qr" src="/images/wechatpay.png" alt="Atcher 微信支付"><p>微信支付</p></div><div id="alipay" style="display:inline-block"> <img id="alipay_qr" src="/images/alipay.png" alt="Atcher 支付宝"><p>支付宝</p></div></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/线程/" rel="tag"><i class="fa fa-tag"></i> 线程</a><a href="/tags/两种实现多线程的区别（面试可能问）/" rel="tag"><i class="fa fa-tag"></i> 两种实现多线程的区别（面试可能问）</a><a href="/tags/同步代码块（锁）/" rel="tag"><i class="fa fa-tag"></i> 同步代码块（锁）</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2019/04/10/javaSE复习之——Properties集合/" rel="next" title="javaSE复习之——Properties集合"><i class="fa fa-chevron-left"></i> javaSE复习之——Properties集合</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/2019/04/10/javaSE复习之——设计模式-单列设计模式/" rel="prev" title="javaSE复习之——设计模式_单列设计模式">javaSE复习之——设计模式_单列设计模式<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/logo.jpg" alt="Atcher"><p class="site-author-name" itemprop="name">Atcher</p><p class="site-description motion-element" itemprop="description">知其然知其所以然</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">85</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"> <a href="/categories/index.html"><span class="site-state-item-count">4</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">153</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/yourname" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="https://www.jianshu.com/u/63445e24e8bf" target="_blank" title="简书"><i class="fa fa-fw fa-heartbeat"></i> 简书</a></span><span class="links-of-author-item"><a href="https://juejin.im/user/5a371ae551882512d0607108" target="_blank" title="掘金"><i class="fa fa-fw fa-spinner"></i> 掘金</a></span></div><div id="days"></div><script>function show_date_time(){window.setTimeout("show_date_time()",1e3),BirthDay=new Date("04/05/2019 12:00:00"),today=new Date,timeold=today.getTime()-BirthDay.getTime(),sectimeold=timeold/1e3,secondsold=Math.floor(sectimeold),msPerDay=864e5,e_daysold=timeold/msPerDay,daysold=Math.floor(e_daysold),e_hrsold=24*(e_daysold-daysold),hrsold=setzero(Math.floor(e_hrsold)),e_minsold=60*(e_hrsold-hrsold),minsold=setzero(Math.floor(60*(e_hrsold-hrsold))),seconds=setzero(Math.floor(60*(e_minsold-minsold))),document.getElementById("days").innerHTML="已运行 "+daysold+" 天 "+hrsold+" 小时 "+minsold+" 分 "+seconds+" 秒"}function setzero(e){return e<10&&(e="0"+e),e}show_date_time()</script></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#线程概述"><span class="nav-number">1.</span> <span class="nav-text">线程概述</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#多线程的应用场景"><span class="nav-number">1.0.1.</span> <span class="nav-text">多线程的应用场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多线程原理-单核CPU"><span class="nav-number">1.0.2.</span> <span class="nav-text">多线程原理(单核CPU)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多线程并行和并发的区别"><span class="nav-number">1.0.3.</span> <span class="nav-text">多线程并行和并发的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多线程程序实现方法1"><span class="nav-number">1.0.4.</span> <span class="nav-text">多线程程序实现方法1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多线程程序实现方法2"><span class="nav-number">1.0.5.</span> <span class="nav-text">多线程程序实现方法2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多线程程序实现方法3"><span class="nav-number">1.0.6.</span> <span class="nav-text">多线程程序实现方法3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#两种实现多线程的区别（面试可能问）"><span class="nav-number">1.0.7.</span> <span class="nav-text">两种实现多线程的区别（面试可能问）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#两种实现多线程的好处与坏处"><span class="nav-number">1.0.8.</span> <span class="nav-text">两种实现多线程的好处与坏处</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Thread类的方法"><span class="nav-number">1.0.9.</span> <span class="nav-text">Thread类的方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#同步代码块的概述"><span class="nav-number">1.0.10.</span> <span class="nav-text">同步代码块的概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#什么时候需要同步？"><span class="nav-number">1.0.11.</span> <span class="nav-text">什么时候需要同步？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#同步代码块关键字"><span class="nav-number">1.0.12.</span> <span class="nav-text">同步代码块关键字</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#定义方式："><span class="nav-number">1.0.13.</span> <span class="nav-text">定义方式：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#同步代码块（锁）的注意事项："><span class="nav-number">1.0.14.</span> <span class="nav-text">同步代码块（锁）的注意事项：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#同步方法如何定义？"><span class="nav-number">1.0.15.</span> <span class="nav-text">同步方法如何定义？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#同步方法注意事项："><span class="nav-number">1.0.16.</span> <span class="nav-text">同步方法注意事项：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#线程安全问题"><span class="nav-number">1.0.17.</span> <span class="nav-text">线程安全问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#以前线程安全类的回顾"><span class="nav-number">1.0.18.</span> <span class="nav-text">以前线程安全类的回顾</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#线程安全方法"><span class="nav-number">1.0.19.</span> <span class="nav-text">线程安全方法</span></a></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2019</span><span class="with-love" id="heart"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Atcher</span></div><div class="theme-info"><div class="powered-by"></div> <span class="post-count">博客全站共53.7k字</span></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv"><i class="fa fa-user"></i> 访问人数<span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span><span class="site-pv"><i class="fa fa-eye"></i> 访问总量<span class="busuanzi-value" id="busuanzi_value_site_pv"></span> 次</span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script></body></html>